{
    "id": "im.pidgin.Pidgin",
    "runtime": "org.gnome.Platform",
    "runtime-version": "42",
    "sdk": "org.gnome.Sdk",
    "command": "pidgin",
    "rename-icon": "pidgin",
    "rename-desktop-file": "pidgin.desktop",
    "finish-args": [
        "--share=ipc",
        "--socket=x11",
        "--share=network",
        "--socket=pulseaudio",
        "--persist=.purple",
        "--filesystem=xdg-download",
        "--talk-name=org.freedesktop.Notifications",
        "--system-talk-name=org.freedesktop.Avahi"
    ],
    "cleanup": [
        "/include",
        "/share/man",
        "/share/info",
        "/share/gtk-doc",
        "/share/aclocal",
        "*.la",
        "*.a"
    ],
    "modules": [
        "shared-modules/gtk2/gtk2.json",
        {
            "name": "gtkspell",
            "rm-configure": true,
            "config-opts": [
                "--disable-gtk-doc",
                "--disable-static"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://sourceforge.net/projects/gtkspell/files/2.0.16/gtkspell-2.0.16.tar.gz",
                    "sha256": "8fc7dc560167b2cb7193e76aca625a152dc19b0ebf49816b78539cbb90d80d02",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 13110,
                        "stable-only": true,
                        "url-template": "https://sourceforge.net/projects/gtkspell/files/$version/gtkspell-$version.tar.gz"
                    }
                },
                {
                    "type": "patch",
                    "path": "enchant-2.diff"
                },
                {
                    "type": "script",
                    "commands": [
                        "autoreconf -sfi"
                    ],
                    "dest-filename": "autogen.sh"
                }
            ]
        },
        {
            "name": "farstream",
            "rm-configure": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "http://freedesktop.org/software/farstream/releases/farstream/farstream-0.2.9.tar.gz",
                    "sha256": "cb7d112433cf7c2e37a8ec918fb24f0ea5cb293cfa1002488e431de26482f47b",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 13757,
                        "stable-only": true,
                        "url-template": "http://freedesktop.org/software/farstream/releases/farstream/farstream-$version.tar.gz"
                    }
                },
                {
                    "type": "patch",
                    "path": "farstream-make-4.3.patch"
                },
                {
                    "type": "script",
                    "commands": [
                        "autoreconf -sfi"
                    ],
                    "dest-filename": "autogen.sh"
                }
            ]
        },
        {
            "name": "avahi",
            "cleanup": [
                "/bin"
            ],
            "config-opts": [
                "--with-distro=none",
                "--disable-libdaemon",
                "--disable-core-docs",
                "--disable-manpages",
                "--disable-mono",
                "--disable-qt3",
                "--disable-qt4",
                "--disable-qt5",
                "--disable-python",
                "--disable-gtk",
                "--disable-gtk3",
                "--disable-static",
                "--disable-libevent"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://avahi.org/download/avahi-0.8.tar.gz",
                    "sha256": "060309d7a333d38d951bc27598c677af1796934dbd98e1024e7ad8de798fedda",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 147,
                        "stable-only": true,
                        "url-template": "https://avahi.org/download/avahi-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "libidn",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/libidn/libidn-1.41.tar.gz",
                    "sha256": "884d706364b81abdd17bee9686d8ff2ae7431c5a14651047c68adf8b31fd8945",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 1639,
                        "stable-only": true,
                        "url-template": "https://ftp.gnu.org/gnu/libidn/libidn-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "cyrus-sasl2",
            "config-opts": [
                "--with-dblib=berkeley",
                "--without-pam",
                "--without-opie",
                "--without-des",
                "--disable-gssapi",
                "--enable-cram",
                "--enable-scram",
                "--enable-digest",
                "--enable-otp",
                "--enable-plain",
                "--enable-login",
                "--with-plugindir=/app/lib/sasl2"
            ],
            "no-parallel-make": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/cyrusimap/cyrus-sasl/releases/download/cyrus-sasl-2.1.27/cyrus-sasl-2.1.27.tar.gz",
                    "sha256": "26866b1549b00ffd020f188a43c258017fa1c382b3ddadd8201536f72efb05d5",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 13280,
                        "stable-only": true,
                        "url-template": "https://github.com/cyrusimap/cyrus-sasl/releases/download/cyrus-sasl-$version/cyrus-sasl-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "libgcrypt",
            "config-opts": [
                "--disable-static",
                "--disable-doc"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://dev.gnupg.org/source/libgcrypt.git",
                    "tag": "libgcrypt-1.10.1",
                    "commit": "ae0e567820c37f9640440b3cff77d7c185aa6742",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 1623,
                        "stable-only": true,
                        "tag-template": "libgcrypt-$version"
                    }
                },
                {
                    "type": "shell",
                    "commands": [
                        "sed -i 's:t-secmem::' tests/Makefile.am",
                        "sed -i 's:t-sexp::' tests/Makefile.am"
                    ]
                }
            ]
        },
        {
            "name": "libotr",
            "rm-configure": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://otr.cypherpunks.ca/libotr-4.1.1.tar.gz",
                    "sha256": "8b3b182424251067a952fb4e6c7b95a21e644fbb27fbd5f8af2b2ed87ca419f5",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 13303,
                        "stable-only": true,
                        "url-template": "https://otr.cypherpunks.ca/libotr-$version.tar.gz"
                    }
                },
                {
                    "type": "shell",
                    "commands": [
                        "sed -i '1 i#include <sys/socket.h>' tests/regression/client/client.c"
                    ]
                }
            ]
        },
        {
            "name": "dbus-glib",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://dbus.freedesktop.org/releases/dbus-glib/dbus-glib-0.112.tar.gz",
                    "sha256": "7d550dccdfcd286e33895501829ed971eeb65c614e73aadb4a08aeef719b143a",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 1979,
                        "stable-only": true,
                        "url-template": "https://dbus.freedesktop.org/releases/dbus-glib/dbus-glib-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "pidgin",
            "config-opts": [
                "--disable-static",
                "--disable-meanwhile",
                "--disable-nm",
                "--enable-cyrus-sasl",
                "--disable-tk",
                "--disable-tcl",
                "--disable-consoleui",
                "--with-python=python3",
                "--disable-gnutls",
                "--with-system-ssl-certs=/etc/ssl/certs",
                "--disable-doxygen",
                "--disable-gevolution"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/pidgin/Pidgin/2.14.10/pidgin-2.14.10.tar.bz2",
                    "sha256": "454b1b928bc6bcbb183353af30fbfde5595f2245a3423a1a46e6c97a2df22810",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 3636,
                        "stable-only": true,
                        "is-main-source": true,
                        "url-template": "https://downloads.sourceforge.net/project/pidgin/Pidgin/$version/pidgin-$version.tar.bz2"
                    }
                },
                {
                    "type": "file",
                    "path": "im.pidgin.Pidgin.appdata.xml"
                },
                {
                    "type": "patch",
                    "path": "add_wm_class.patch"
                }
            ],
            "post-install": [
                "chmod 755 /app/lib/pidgin/perl/auto/Pidgin/Pidgin.so",
                "chmod 755 /app/lib/purple-2/perl/auto/Purple/Purple.so",
                "install -Dm644 im.pidgin.Pidgin.appdata.xml /app/share/appdata/im.pidgin.Pidgin.appdata.xml"
            ]
        },
        {
            "name": "pidgin-otr",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://otr.cypherpunks.ca/pidgin-otr-4.0.2.tar.gz",
                    "sha256": "f4b59eef4a94b1d29dbe0c106dd00cdc630e47f18619fc754e5afbf5724ebac4",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 10240,
                        "stable-only": true,
                        "url-template": "https://otr.cypherpunks.ca/pidgin-otr-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "purple-plugin-pack",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://sourceforge.net/projects/pidgin/files/purple%20plugin%20pack/2.8.0/purple-plugin-pack-2.8.0.tar.xz",
                    "sha256": "82ccde9a7251a75b7e03a3f9a929014d8e008c1b6f46e58638f5f476da3e242d"
                }
            ]
        }
    ]
}
